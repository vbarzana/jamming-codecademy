(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,a){e.exports=a(31)},19:function(e,t,a){},21:function(e,t,a){},23:function(e,t,a){},25:function(e,t,a){},27:function(e,t,a){},29:function(e,t,a){},31:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(10),o=a.n(c),i=a(2),s=a.n(i),l=a(8),u=a(3),p=a(4),h=a(7),y=a(5),d=a(6),f=a(1),k=(a(19),a(21),function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(y.a)(t).call(this,e))).onSearchClick=a.onSearchClick.bind(Object(f.a)(Object(f.a)(a))),a.doSearch=a.doSearch.bind(Object(f.a)(Object(f.a)(a))),a.onSearchKeyPress=a.onSearchKeyPress.bind(Object(f.a)(Object(f.a)(a))),a}return Object(d.a)(t,e),Object(p.a)(t,[{key:"onSearchClick",value:function(e){e.preventDefault(),this.doSearch()}},{key:"doSearch",value:function(){var e=document.querySelector(".SearchBar input").value;this.props.onSearchChange&&this.props.onSearchChange(e)}},{key:"onSearchKeyPress",value:function(e){if(console.log(e),13===e.charCode)return this.doSearch()}},{key:"render",value:function(){return r.a.createElement("div",{className:"SearchBar"},r.a.createElement("input",{placeholder:"Search in Spotify",onKeyPress:this.onSearchKeyPress}),r.a.createElement("button",{onClick:this.onSearchClick},"SEARCH"))}}]),t}(r.a.Component)),m=(a(23),a(25),function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(y.a)(t).call(this,e))).handleAddTrackClick=a.handleAddTrackClick.bind(Object(f.a)(Object(f.a)(a))),a.handlePlayTrack=a.handlePlayTrack.bind(Object(f.a)(Object(f.a)(a))),a}return Object(d.a)(t,e),Object(p.a)(t,[{key:"handleAddTrackClick",value:function(e){return this.props.onToggleTrackToPlaylist(this.props.trackId),e.preventDefault()}},{key:"handlePlayTrack",value:function(e){return this.props.onToggleTrackPlay(this.props.trackId),e.preventDefault()}},{key:"render",value:function(){var e=this.props.inPlaylist?"remove_circle_outline":"add",t="Track "+(this.props.playingNow?"playing-now":"");return r.a.createElement("div",{className:t},r.a.createElement("div",{className:"Track-information"},r.a.createElement("h3",null,this.props.title),r.a.createElement("p",null,this.props.artist," | ",this.props.album)),r.a.createElement("a",{className:"Track-action",onClick:this.handleAddTrackClick},r.a.createElement("i",{className:"material-icons"},e)),r.a.createElement("a",{className:"Track-play-button",onClick:this.handlePlayTrack},r.a.createElement("i",{className:"material-icons"},"play_circle_outline")))}}]),t}(r.a.Component)),v=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"TrackList"},this.props.tracks.map(function(t){return r.a.createElement(m,{key:t.id,trackId:t.id,inPlaylist:t.inPlaylist,album:t.album,onToggleTrackToPlaylist:e.props.onToggleTrackToPlaylist,onToggleTrackPlay:e.props.onToggleTrackPlay,artist:t.artist,playingNow:t.playingNow,title:t.name})}))}}]),t}(r.a.Component),b=(a(27),function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(y.a)(t).call(this,e))).handleSaveToSpotify=a.handleSaveToSpotify.bind(Object(f.a)(Object(f.a)(a))),a}return Object(d.a)(t,e),Object(p.a)(t,[{key:"handleSaveToSpotify",value:function(e){var t=document.querySelector(".Playlist input").value;this.props.onSaveToSpotify(t),e.preventDefault()}},{key:"render",value:function(){return r.a.createElement("div",{className:"Playlist"},r.a.createElement("input",{defaultValue:"New Playlist"}),r.a.createElement(v,{tracks:this.props.tracks,onToggleTrackToPlaylist:this.props.onToggleTrackToPlaylist,onToggleTrackPlay:this.props.onToggleTrackPlay}),r.a.createElement("button",{className:"Playlist-save",onClick:this.handleSaveToSpotify},"SAVE TO SPOTIFY"))}}],[{key:"clearPlaylist",value:function(){var e=document.querySelector(".Playlist input");e&&(e.value="New Playlist")}}]),t}(r.a.Component)),T="995a333951874e1ea83aa9cfabecb0db";console.log(T),console.log("http://localhost:3000/callback");var g="https://api.spotify.com/v1",j=null,O=null,S=function(){j=null,window.location.hash="",O=null,P.login()},P=function(){function e(){Object(u.a)(this,e)}return Object(p.a)(e,null,[{key:"getTokenFromHash",value:function(){if(j)return j;var t=function(){for(var e,t={},a=/([^&;=]+)=?([^&;]*)/g,n=window.location.hash.substring(1);e=a.exec(n);)t[e[1]]=decodeURIComponent(e[2]);return t}();j=t.access_token;var a=1e3*parseInt(t.expires_in,10);return j?(setTimeout(function(){return S},a),j):e.login()}},{key:"getUserId",value:function(){var t=Object(l.a)(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!O){t.next=2;break}return t.abrupt("return",O);case 2:return t.abrupt("return",fetch("".concat(g,"/me"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.getTokenFromHash())}}).then(function(e){if(e.ok)return e.json();throw new Error("Invalid response")}).then(function(e){return O=e.id}));case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"createPlaylist",value:function(){var t=Object(l.a)(s.a.mark(function t(a,n){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,e.doCreatePlaylist(a);case 5:r=t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),console.log(t.t0);case 11:return t.prev=11,t.next=14,e.addTracksToPlaylist(r,n);case 14:t.next=19;break;case 16:t.prev=16,t.t1=t.catch(11),console.log(t.t1);case 19:case"end":return t.stop()}},t,this,[[2,8],[11,16]])}));return function(e,a){return t.apply(this,arguments)}}()},{key:"doCreatePlaylist",value:function(){var t=Object(l.a)(s.a.mark(function t(a){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getUserId();case 2:return n=t.sent,t.abrupt("return",fetch("".concat(g,"/users/").concat(n,"/playlists"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.getTokenFromHash())},body:JSON.stringify({name:a})}).then(function(e){if(e.ok)return e.json();throw new Error("Invalid response")}));case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"addTracksToPlaylist",value:function(){var t=Object(l.a)(s.a.mark(function t(a,n){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch("".concat(g,"/playlists/").concat(a.id,"/tracks"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.getTokenFromHash())},body:JSON.stringify({uris:(n||[]).map(function(e){return e.uri})})}).then(function(e){if(e.ok)return e.json();throw new Error("Invalid response")}));case 1:case"end":return t.stop()}},t,this)}));return function(e,a){return t.apply(this,arguments)}}()},{key:"login",value:function(){var e="https://accounts.spotify.com/authorize?response_type=token&client_id=".concat(encodeURIComponent(T),"&scope=").concat(encodeURIComponent("playlist-modify-public"),"&redirect_uri=").concat(encodeURIComponent("http://localhost:3000/callback"));window.location=e}},{key:"search",value:function(){var t=Object(l.a)(s.a.mark(function t(a,n){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.getTokenFromHash("search",[a,n]),a=encodeURIComponent(a),n||(n="album,artist,playlist,track"),n=encodeURIComponent(n),t.abrupt("return",fetch("".concat(g,"/search?q=").concat(a,"&type=").concat(n),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)}}).then(function(e){if(e.ok)return e.json();throw S(),new Error("Request failed!")}).then(function(e){return(e&&e&&e.tracks.items||[]).map(function(e){return{id:e.id,uri:e.uri,album:e.album.name,name:e.name,artist:e.artists[0]&&e.artists[0].name}})}));case 5:case"end":return t.stop()}},t,this)}));return function(e,a){return t.apply(this,arguments)}}()}]),e}(),w=P,C=(a(29),function(e){var t=e.currentTrackId;if(!t)return null;var a="https://open.spotify.com/embed/track/".concat(t);return r.a.createElement("div",{className:"Player"},r.a.createElement("h2",null,"Listen"),r.a.createElement("br",null),r.a.createElement("iframe",{src:a,title:t,width:"500",height:"80",allowtransparency:"true",frameBorder:"0",allow:"encrypted-media"}))}),E=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(y.a)(t).call(this,e))).state={currentTrackId:null,searchResults:[],playListTracks:[]},a.onSearchChange=a.onSearchChange.bind(Object(f.a)(Object(f.a)(a))),a.addToPlaylist=a.addToPlaylist.bind(Object(f.a)(Object(f.a)(a))),a.removeFromPlaylist=a.removeFromPlaylist.bind(Object(f.a)(Object(f.a)(a))),a.onSaveToSpotify=a.onSaveToSpotify.bind(Object(f.a)(Object(f.a)(a))),a.previewInPlayer=a.previewInPlayer.bind(Object(f.a)(Object(f.a)(a))),a}return Object(d.a)(t,e),Object(p.a)(t,[{key:"onSearchChange",value:function(){var e=Object(l.a)(s.a.mark(function e(t){var a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,w.search(t);case 5:a=e.sent,this.setState({searchResults:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}},e,this,[[2,9]])}));return function(t){return e.apply(this,arguments)}}()},{key:"addToPlaylist",value:function(e){var t=this.state.playListTracks;if(!t.filter(function(t){return t.id===e})[0]){var a=this.state.searchResults.filter(function(t){return t.id===e})[0];a&&(t.push(Object.assign({inPlaylist:!0},a)),this.setState({playListTracks:t}))}}},{key:"previewInPlayer",value:function(e){var t=function(t){return t.playingNow&&(t.playingNow=!1),t.id===e&&(t.playingNow=!0),t},a=this.state.searchResults.map(t),n=this.state.playListTracks.map(t);this.setState({searchResults:a,playListTracks:n,currentTrackId:e})}},{key:"removeFromPlaylist",value:function(e){var t=this.state.playListTracks,a=-1;t.filter(function(t,n){return t.id===e&&(a=n),t.id===e})[0]&&a>-1&&(t.splice(a,1),this.setState({playListTracks:t}))}},{key:"onSaveToSpotify",value:function(){var e=Object(l.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.createPlaylist(t,this.state.playListTracks);case 3:this.setState({playListTracks:[]}),b.clearPlaylist(),alert("Playlist ".concat(t," successfully created!")),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),alert(e.t0.message);case 12:case"end":return e.stop()}},e,this,[[0,8]])}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(k,{onSearchChange:this.onSearchChange}),r.a.createElement(C,{currentTrackId:this.state.currentTrackId}),r.a.createElement("div",{className:"App-playlist"},r.a.createElement("div",{className:"SearchResults"},r.a.createElement("h2",null,"Results"),r.a.createElement(v,{tracks:this.state.searchResults,onToggleTrackToPlaylist:this.addToPlaylist,onToggleTrackPlay:this.previewInPlayer})),r.a.createElement(b,{tracks:this.state.playListTracks,onToggleTrackToPlaylist:this.removeFromPlaylist,onSaveToSpotify:this.onSaveToSpotify,onToggleTrackPlay:this.previewInPlayer})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[11,2,1]]]);
//# sourceMappingURL=main.00be096a.chunk.js.map